<app-contenedor 
    [icon]="'fa fa-search'" 
    [col]="'col-sm-8'"
    [titulo]="'Buscar Tipo Permiso'" 
    [banderaEstado]="banderaEstado"
    [loadingPantalla]="loadingPantalla"
    (recargarChange)="reload()"
>
    <div class="formGroup col-md-12">
      <button
        (click)="inicializarForma('Registrar tipo permiso', lgModalTipoPermiso)"
        mat-raised-button color="primary"
      >
        Nuevo
      </button>
    </div>
    <form class="mt-4">
        <div class="form-row col-sm-12">
            <mat-form-field appearance="legacy" class="form-group col-sm-2 p-3">
                <mat-label>Mostrar</mat-label>
                <mat-select [(value)]="paginado.cantidadMostrar" name="cantidadMostrar" (selectionChange)="buscarPaginado({ offset: 0 })">
                    <mat-option *ngFor="let numero of cantidadMostrar" [value]="numero">{{numero}}</mat-option>
                </mat-select>
              </mat-form-field>
            
          <mat-form-field appearance="legacy" class="form-group col-sm-3">
            <mat-label>filtrar por</mat-label>
            <mat-select [(ngModel)]="busqueda.parametro" name="cantidadMostrar">
                <mat-option value="descripcion">Descripción</mat-option>
            </mat-select>
          </mat-form-field>
          
            <mat-form-field appearance="legacy" class="form-group col-sm-5 p-3">
                <mat-label>Buscador</mat-label>
                <input matInput class="text-uppercase" [(ngModel)]="busqueda.valor" name="valor">
            </mat-form-field>
          
            <button mat-raised-button color="primary"
                class="form-group col-sm-2"
                (click)="buscarPaginado({ offset: 0 })" 
            >Buscar</button>
        </div>
    </form>
    <div
        *ngIf="array.length == 0 && !banderaCargando; else show"
        class="card mb-3"
      >
        <div class="card-body text-center p-2">
            <i class="fa fa-inbox fa-2x"></i>
          <h5 class="card-title"> No se encontró ningún resultado</h5>
        </div>
      </div>

      <ng-template #show>
        <ngx-datatable
          #table
          class="material"
          [rows]="array"
          [headerHeight]="40"
          [columnMode]="'force'" 
          [footerHeight]="50"
          [rowHeight]="'auto'"
          [loadingIndicator]="this.banderaCargando"
          [externalPaging]="true"
          [count]="paginado.totalElementos"
          [limit]="paginado.cantidadMostrar"
          [offset]="paginado.numeroPaginaActual"
          (page)="buscarPaginado($event)"
          [scrollbarH]="true"
        >
          <ngx-datatable-column name="" prop="id" [width]="55">
            <ng-template ngx-datatable-cell-template let-value="value">
              <div class="text-center">
                <button
                  class="btn btn-success mr-2"
                  matTooltip="Editar registro"
                  (click)="modificarRegistro(value, lgModalTipoPermiso)"
                  >
                  <i class="fa fa-pencil"></i>
                </button>
                <button
                  class="btn btn-danger"
                  matTooltip="Eliminar registro"
                  (click)="eliminarRegistro(value)"
                >
                  <i class="fa fa-trash"></i>
                </button>
              </div>
            </ng-template>
          </ngx-datatable-column>

          <ngx-datatable-column name="DECRIPCIÓN" prop="descripcion"  [width]="450">
            <ng-template ngx-datatable-cell-template let-value="value">
              {{ value }}
            </ng-template>
          </ngx-datatable-column>

        </ngx-datatable>
      </ng-template>
</app-contenedor>

<app-modalpopup
  bsModal
  #lgModalTipoPermiso="bs-modal"
  [config]="{ backdrop: 'static' }"
  class="modal fade"
  tabindex="-1"
  role="dialog"
  aria-labelledby="dialog-sizes-name"
  [lgModal]="lgModalTipoPermiso"
  [titulo]="tituloModal"
  [modalSize]="'modal-sm'"
  [icon]="'fa fa-save'"
  [headerColor]="'card-header'"
  (guardarEvent)="registrarTipoPermiso(lgModalTipoPermiso)"
>
<form [formGroup]="tipoPermisoForma" *ngIf="tipoPermisoForma">
  <div class="row">
    <div class="form-row col-sm-12">
      <mat-form-field appearance="legacy" class="form-group col-sm-12 p-3">
          <mat-label>Descripción</mat-label>
          <input matInput formControlName="descripcion" class="text-uppercase">
      </mat-form-field>
    </div>
  </div>
  
</form>
</app-modalpopup>
