<app-contenedor 
    [icon]="'fa fa-search'" 
    [col]="'col-sm-10'"
    [titulo]="'Buscar Empleado'" 
    [banderaEstado]="banderaEstado"
    (recargarChange)="reload()"
>
    <div class="formGroup col-md-12">
      <button
        (click)="inicializarForma('Registrar empleado', lgModalEmpleado)"
        mat-raised-button color="primary"
      >
        Nuevo
      </button>
    </div>
    <form class="mt-4">
        <div class="form-row col-sm-12">
            <mat-form-field appearance="legacy" class="form-group col-md-2 p-3">
                <mat-label>Mostrar</mat-label>
                <mat-select [(value)]="paginado.cantidadMostrar" name="cantidadMostrar" (selectionChange)="buscarPaginado({ offset: 0 })">
                    <mat-option *ngFor="let numero of cantidadMostrar" [value]="numero">{{numero}}</mat-option>
                </mat-select>
              </mat-form-field>
            
          <mat-form-field appearance="legacy" class="form-group col-md-4">
            <mat-label>filtrar por</mat-label>
            <mat-select [(ngModel)]="busqueda.parametro" name="cantidadMostrar">
                <mat-option value="nombreEmpleado">Nombre del Empleado</mat-option>
            </mat-select>
          </mat-form-field>
          
            <mat-form-field appearance="legacy" class="form-group col-sm-5 p-3">
                <mat-label>Buscador</mat-label>
                <input matInput class="text-uppercase" [(ngModel)]="busqueda.valor" name="valor">
            </mat-form-field>
          
            <button mat-raised-button color="primary"
                class="form-group col-md-1"
                (click)="buscarPaginado({ offset: 0 })" 
            >Buscar</button>
        </div>
    </form>
    <div
        *ngIf="array.length == 0 && !banderaCargando; else show"
        class="card mb-3"
      >
        <div class="card-body text-center p-2">
            <i class="fa fa-inbox fa-2x"></i>
          <h5 class="card-title"> No se encontró ningún resultado</h5>
        </div>
      </div>

      <ng-template #show>
        <ngx-datatable
          #table
          class="material"
          [rows]="array"
          [headerHeight]="40"
          [columnMode]="'force'" 
          [footerHeight]="50"
          [rowHeight]="'auto'"
          [loadingIndicator]="this.banderaCargando"
          [externalPaging]="true"
          [count]="paginado.totalElementos"
          [limit]="paginado.cantidadMostrar"
          [offset]="paginado.numeroPaginaActual"
          (page)="buscarPaginado($event)"
          [scrollbarH]="true"
        >
          <ngx-datatable-column name="" prop="id" [width]="65">
            <ng-template ngx-datatable-cell-template let-value="value">
              <div class="text-center">
                <button
                  class="btn btn-success mr-2"
                  matTooltip="Editar registro"
                  (click)="modificarRegistro(value, lgModalEmpleado)"
                >
                  <i class="fa fa-pencil"></i>
                </button>
                <button
                  class="btn btn-danger"
                  matTooltip="Eliminar registro"
                >
                  <i class="fa fa-trash"></i>
                </button>
              </div>
            </ng-template>
          </ngx-datatable-column>

          <ngx-datatable-column name="NOMBRE" prop="nombreEmpleado"  [width]="100">
            <ng-template ngx-datatable-cell-template let-value="value">
              {{ value }}
            </ng-template>
          </ngx-datatable-column>

          <ngx-datatable-column name="APELLIDOS" prop="apellidosEmpleado"  [width]="200">
            <ng-template ngx-datatable-cell-template let-value="value">
              {{ value }}
            </ng-template>
          </ngx-datatable-column>

          <ngx-datatable-column name="FECHA NACIMIENTO" prop="fechaNacimiento" [width]="100">
            <ng-template ngx-datatable-cell-template let-value="value">
              {{ value | date: "dd/MM/yyyy" }}
            </ng-template>
          </ngx-datatable-column>

          <ngx-datatable-column name="FECHA INGRESO" prop="fechaIngreso" [width]="100">
            <ng-template ngx-datatable-cell-template let-value="value">
                {{ value | date: "dd/MM/yyyy" }}
            </ng-template>
          </ngx-datatable-column>

        </ngx-datatable>
      </ng-template>
</app-contenedor>
<!-- <app-contenedor color="primary"
  [titulo]="'Registro de empleados'"
  [banderaEstado]="banderaEstado"
  [col]="'col-md-5'"
  [loadingPantalla] = "loadingPantalla"
  [icon]="'fa fa-save'"
>
<form [formGroup]="empleadoForma" *ngIf="empleadoForma">
  <div class="row">
    <div class="form-row col-sm-12">
      <mat-form-field appearance="legacy" class="form-group col-sm-6 p-3">
          <mat-label>Nombre</mat-label>
          <input matInput formControlName="nombreEmpleado" class="text-uppercase">
      </mat-form-field>
      <mat-form-field appearance="legacy" class="form-group col-sm-6">
          <mat-label>Apellidos</mat-label>
          <input matInput formControlName="apellidosEmpleado" class="text-uppercase">
      </mat-form-field>
    </div>
    <div class="form-row col-sm-12">
      <mat-form-field appearance="legacy" class="form-group col-sm-6 p-3">
          <mat-label>Fecha de Nacimiento</mat-label>
          <input matInput [matDatepicker]="pickerNacimiento" (dateChange)="empleadoForma.get('fechaNacimiento')?.setValue($event.value.toDate())" formControlName="fechaNacimiento" (focus)="pickerNacimiento.open()" readonly>
          <mat-icon matSuffix style="cursor: pointer;" matTooltip="Fecha de Nacimiento">calendar_month_outlined</mat-icon>
          <mat-datepicker #pickerNacimiento></mat-datepicker>
      </mat-form-field>
      <mat-form-field appearance="legacy" class="form-group col-sm-6">
          <mat-label>Fecha de Ingreso</mat-label>
          <input matInput [matDatepicker]="pickerIngreso" (dateChange)="empleadoForma.get('fechaIngreso')?.setValue($event.value.toDate())" formControlName="fechaIngreso" (focus)="pickerIngreso.open()" readonly>
          <mat-icon matSuffix style="cursor: pointer;" matTooltip="Fecha de Ingreso">calendar_month_outlined</mat-icon>
          <mat-datepicker #pickerIngreso></mat-datepicker>
      </mat-form-field>
    </div>
  </div>
  <div class="text-center pt-3">
    <button mat-raised-button color="primary" (click)="registrarEmpleado()">Guardar</button>
  </div>
</form>

</app-contenedor> -->

<app-modalpopup
  bsModal
  #lgModalEmpleado="bs-modal"
  [config]="{ backdrop: 'static' }"
  class="modal fade"
  tabindex="-1"
  role="dialog"
  aria-labelledby="dialog-sizes-name"
  [lgModal]="lgModalEmpleado"
  [titulo]="tituloModal"
  [modalSize]="'modal-md'"
  [icon]="'fa fa-save'"
  [headerColor]="'card-header'"
  (guardarEvent)="registrarEmpleado(lgModalEmpleado)"
>
<form [formGroup]="empleadoForma" *ngIf="empleadoForma">
  <div class="row">
    <div class="form-row col-sm-12">
      <mat-form-field appearance="legacy" class="form-group col-sm-6 p-3">
          <mat-label>Nombre</mat-label>
          <input matInput formControlName="nombreEmpleado" class="text-uppercase">
      </mat-form-field>
      <mat-form-field appearance="legacy" class="form-group col-sm-6">
          <mat-label>Apellidos</mat-label>
          <input matInput formControlName="apellidosEmpleado" class="text-uppercase">
      </mat-form-field>
    </div>
    <div class="form-row col-sm-12">
      <mat-form-field appearance="legacy" class="form-group col-sm-6 p-3">
          <mat-label>Fecha de Nacimiento</mat-label>
          <input matInput [matDatepicker]="pickerNacimiento" (dateChange)="empleadoForma.get('fechaNacimiento')?.setValue($event.value.toDate())" formControlName="fechaNacimiento" (focus)="pickerNacimiento.open()" readonly>
          <mat-icon matSuffix style="cursor: pointer;" matTooltip="Fecha de Nacimiento">calendar_month_outlined</mat-icon>
          <mat-datepicker #pickerNacimiento></mat-datepicker>
      </mat-form-field>
      <mat-form-field appearance="legacy" class="form-group col-sm-6">
          <mat-label>Fecha de Ingreso</mat-label>
          <input matInput [matDatepicker]="pickerIngreso" (dateChange)="empleadoForma.get('fechaIngreso')?.setValue($event.value.toDate())" formControlName="fechaIngreso" (focus)="pickerIngreso.open()" readonly>
          <mat-icon matSuffix style="cursor: pointer;" matTooltip="Fecha de Ingreso">calendar_month_outlined</mat-icon>
          <mat-datepicker #pickerIngreso></mat-datepicker>
      </mat-form-field>
    </div>
  </div>
  <!-- <div class="text-center pt-3">
    <button mat-raised-button color="primary" (click)="registrarEmpleado()">Guardar</button>
  </div> -->
</form>
</app-modalpopup>
